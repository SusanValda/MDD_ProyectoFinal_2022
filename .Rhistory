View(bd_enna)
#Carga de datos
load(url("https://github.com/AlvaroLimber/EST-384/blob/master/data/nna16.RData?raw=true"))
View(nna)
View(nna)
install.packages("rpart")
install.packages("rpart")
#install.packages("rpart")
library(rpart)
#install.packages("rpart")
library(rpart)
names(nna)
str(nna)#estrucutra
aux<-c("depto","area","ns001a_02","ns001a_03","ns01a_01","ns01a_02a","ns01a_02b","ns01a_04","ns01a_05c","ns01a_06","ns01a_07","ns02a_01","ns02a_05","ns02b_15","ns02b_19_2a","ns02b_20","ns02c_26","ns03a_04","ns03b_06","ncob_op","ncaeb_op","catactlab","catactlab_pd2")
for(i in aux){
table(is.na(nna[[i]]))
}
for(i in aux){
View(nna[is.na(nna[[i]])])
}
View(nna[is.na(nna[[i]]),])
table(is.na(nna[[i]]))
table(is.na(nna$depto))
table(is.na(nna$area))
table(is.na(nna$aux[[1]]))
table(is.na(nna$aux[[0]]))
table(is.na(nna$aux[1]))
table(is.na(nna$ns001a_02))
table(is.na(nna$ns001a_03))
table(is.na(nna$aux(1)))
library(dplyr)
bd <- nna %>% select(depto,area,ns001a_02,ns001a_03,ns01a_01,ns01a_02a,ns01a_02b,ns01a_04,ns01a_05c,ns01a_06,ns01a_07,ns02a_01,ns02a_05,ns02b_15,ns02b_19_2a,ns02b_20,ns02c_26,ns03a_04,ns03b_06,estrato,ncob_op,ncaeb_op,catactlab,catactlab_pd2)
View(bd)
View(bd)
for(i in aux){
table(is.na(nna[[i]]))
}
for(i in aux){
table(is.na(nna[[i]]))
}
table(is.na(nna$aux[[0]]))
t1<-table(is.na(nna$aux[[0]]))
t1<-table(is.na(nna$aux[[2]]))
t1<-table(is.na(nna$aux[[23]]))
aux<-c("depto")
for(i in aux){
table(is.na(nna[[i]]))
}
t1 <- table(is.na(nna[[i]]))
bd <- na.omit(bd)
bd <- nna %>% select(depto,area,ns001a_02,ns001a_03,ns01a_01,ns01a_02a,ns01a_02b,ns01a_04,ns01a_05c,ns01a_06,ns01a_07,ns02a_01,ns02a_05,ns02b_15,ns02b_19_2a,ns02b_20,ns02c_26,ns03a_04,ns03b_06,estrato,ncob_op,ncaeb_op,catactlab,catactlab_pd2)
bd <- na.omit(bd)
bd <- nna %>% select(depto,area,ns001a_02,ns001a_03,ns01a_01,ns01a_02a,ns01a_02b,ns01a_04,ns01a_05c,ns01a_06,ns01a_07,ns02a_01,ns02a_05,ns02b_15,ns02b_19_2a,ns02b_20,ns02c_26,ns03a_04,ns03b_06,estrato,ncob_op,ncaeb_op,catactlab,catactlab_pd2)
View(bd)
View(bd)
bd <- nna %>% select(depto,area,ns001a_02,ns001a_03,ns01a_01,ns01a_02a,ns01a_02b,ns01a_05c,ns01a_06,ns02a_01,ns02a_05,ns02b_15,ns02b_19_2a,ns02b_20,ns02c_26,ns03a_04,ns03b_06,estrato,ncob_op,ncaeb_op,catactlab,catactlab_pd2)
bd <- nna %>% select(depto,area,ns001a_02,ns001a_03,ns01a_01,ns01a_02a,ns01a_02b,ns01a_05c,ns01a_06,ns02a_01,ns02b_15,ns02b_19_2a,ns02b_20,ns02c_26,ns03a_04,ns03b_06,estrato,ncob_op,ncaeb_op,catactlab,catactlab_pd2)
bd <- nna %>% select(condac,depto,area,ns001a_02,ns001a_03,ns01a_01,ns01a_02a,ns01a_02b,ns01a_05c,ns01a_06,ns02a_01,ns02b_15,ns02b_19_2a,ns02b_20,ns02c_26,ns03a_04,ns03b_06,estrato,ncob_op,ncaeb_op,catactlab,catactlab_pd2)
bd <- nna %>% select(condac,depto,area,ns001a_02,ns001a_03,ns01a_01,ns01a_02a,ns01a_02b,ns01a_05c,ns01a_06,ns02a_01,ns02b_15,ns02b_19_2a,ns02b_20,ns02c_26,ns03a_04,ns03b_06,ncob_op,ncaeb_op,catactlab,catactlab_pd2)
aux<-c("condac","depto","area","ns001a_02","ns001a_03","ns01a_01","ns01a_02a","ns01a_02b","ns01a_05c","ns01a_06","ns02a_01","ns02b_19_2a","ns02b_20","ns02c_26","ns03a_04","ns03b_06","ncob_op","ncaeb_op","catactlab","catactlab_pd2")
bd <- nna %>% select(condac,depto,area,ns001a_02,ns001a_03,ns01a_01,ns01a_02a,ns01a_02b,ns01a_05c,ns01a_06,ns02a_01,ns02b_15,ns02b_19_2a,ns02b_20,ns02c_26,ns03a_04,ns03b_06,ncob_op,ncaeb_op,catactlab,catactlab_pd2)
aux<-c("condac","depto","area","ns001a_02","ns001a_03","ns01a_01","ns01a_02a","ns01a_02b","ns01a_05c","ns01a_06","ns02a_01","ns02b_15","ns02b_19_2a","ns02b_20","ns02c_26","ns03a_04","ns03b_06","ncob_op","ncaeb_op","catactlab","catactlab_pd2")
library(dplyr)
covid<-read.csv("C:\\Users\\ALVARO\\Documents\\GitHub\\EST-384\\data\\covid_mx\\200627COVID19MEXICO.csv",sep=",",na.strings = c(99,98))
load(url("https://github.com/AlvaroLimber/EST-384/blob/master/data/covid_mx/covid_mx.Rdata?raw=true"))
##################################################
#a factor (X)
##################################################
#sexo
covid$SEXO<-factor(covid$SEXO,levels=1:2,labels=c("Mujer","Hombre"))
#resultado
covid$RESULTADO<-factor(covid$RESULTADO,levels = 1:3,labels=c("COVID +","COVID -","COVID pendiende"))
covid2<-covid#para cart
#si/no
aux<-c("NEUMONIA","HABLA_LENGUA_INDIG","DIABETES","EPOC","ASMA","INMUSUPR","HIPERTENSION","OTRA_COM","CARDIOVASCULAR","OBESIDAD","RENAL_CRONICA","TABAQUISMO")
#install.packages("rpart")
library(rpart)
covid2$muerte<-factor(covid2$muerte,c(T,F),labels = c("Muerte","No muerte"))
table(covid$muerte)## clasificación (Y)
covid<-covid %>% select(vv)
#variable muerte
covid<-covid %>% mutate(muerte=(FECHA_DEF!="9999-99-99")) %>% select(-FECHA_DEF)
# valores perdidos
covid<-na.omit(covid)
load(url("https://github.com/AlvaroLimber/EST-384/blob/master/data/covid_mx/covid_mx.Rdata?raw=true"))
vv<-c("SEXO","FECHA_DEF","NEUMONIA","EDAD","HABLA_LENGUA_INDIG","DIABETES","EPOC","ASMA","INMUSUPR","HIPERTENSION","OTRA_COM","CARDIOVASCULAR","OBESIDAD","RENAL_CRONICA","TABAQUISMO","RESULTADO")
covid<-covid %>% select(vv)
#Descripción
library(Hmisc)
describe(covid)
Hmisc::describe(covid)
#variable muerte
covid<-covid %>% mutate(muerte=(FECHA_DEF!="9999-99-99")) %>% select(-FECHA_DEF)
##################################################
#a factor (X)
##################################################
#sexo
covid$SEXO<-factor(covid$SEXO,levels=1:2,labels=c("Mujer","Hombre"))
#resultado
covid$RESULTADO<-factor(covid$RESULTADO,levels = 1:3,labels=c("COVID +","COVID -","COVID pendiende"))
covid2<-covid#para cart
covid2$muerte<-factor(covid2$muerte,c(T,F),labels = c("Muerte","No muerte"))
#si/no
aux<-c("NEUMONIA","HABLA_LENGUA_INDIG","DIABETES","EPOC","ASMA","INMUSUPR","HIPERTENSION","OTRA_COM","CARDIOVASCULAR","OBESIDAD","RENAL_CRONICA","TABAQUISMO")
covid2[[i]]<-factor(covid2[[i]],1:2,c("SI","NO"))
for(i in aux){
covid2[[i]]<-factor(covid2[[i]],1:2,c("SI","NO"))
}
str(covid2)
View(covid2)
View(covid2)
describe(nna$ns001a_02)
describe(nna$ns001a_03)
describe(nna$ns01a_01)
bd$ns01a_01<-factor(bd$ns01a_01,1.Si:2.No,c("SI","NO"))
bd$ns01a_01<-factor(bd$ns01a_01,"1.Si":"2.No",c("SI","NO"))
bd$ns01a_01<-factor(bd$ns01a_01,"1.Si":"2.No",c("SI","NO"))
bd$ns01a_01<-factor(bd$ns01a_01,c("1.Si","2.No"),c("SI","NO"))
bd$ns01a_06<-factor(bd$ns01a_06,c("1.Si","2.No"),c("SI","NO"))
bd$ns02a_01<-factor(bd$ns02a_01,c("1.Si","2.No"),c("SI","NO"))
aux<-c("ns01a_01","ns01a_06","ns02a_01","ns03a_04","ns03b_06")
bd[[i]]<-factor(bd[[i]],c("1.Si","2.No"),c("SI","NO"))
for(i in aux){
bd[[i]]<-factor(bd[[i]],c("1.Si","2.No"),c("SI","NO"))
}
aux<-c("ns01a_01","ns01a_06","ns02a_01","ns02b_20","ns03a_04","ns03b_06")
bd <- nna %>% select(condac,depto,area,ns001a_02,ns001a_03,ns01a_01,ns01a_02a,ns01a_02b,ns01a_05c,ns01a_06,ns02a_01,ns02b_15,ns02b_19_2a,ns02b_20,ns02c_26,ns03a_04,ns03b_06,ncob_op,ncaeb_op,catactlab,catactlab_pd2)
for(i in aux){
bd[[i]]<-factor(bd[[i]],c("1.Si","2.No"),c("SI","NO"))
}
## Bases: trainbd, testbd
library(rpart)
set.seed(123)
index = sample(1:2, nrow(bd), replace = TRUE, prob=c(0.7, 0.3))
prop.table(table(index))
trainbd<-bd[index==1,]
testbd<-bd[index==2,]
mod1<-rpart(condac~.,data=trainbd)
#Explorar los nodos creados por rpart
mod1
#Examinar los parámetros del árbol con printcp
printcp(mod1)
#Usar el comando plotcp para explorar los parámetros de forma gráfica
plotcp(mod1)
#Usar la función summary para para examinar el modelo
summary(mod1)
#Visualizar el árbol
plot(mod1)
text(mod1,all=T,use.n=T)
install.packages("rpart.plot")
#install.packages("rpart.plot")
library(rpart.plot)
#install.packages("rpart.plot")
library(rpart.plot)
rpart.plot(mod1)
bd <- rename(c(ns01a_01="sabeLeer"))
bd <- rename(bd,c(ns01a_01="sabeLeer"))
bd <- rename(bd, c(ns01a_01="sabeLeer"))
bd <- rename(bd, c(sabeLeer="ns01a_01"))
View(bd)
View(bd)
bd <- rename(bd, c(sabeLeer="ns01a_01")) %>%
rename(bd, c(sexo="ns001a_02")) %>%
rename(bd, c(edad="ns001a_03")) %>%
rename(bd, c(nivel_ciclo="ns01a_02a")) %>%
rename(bd, c(curso_grado="ns01a_02b")) %>%
rename(bd, c(turno="ns01a_05c")) %>%
rename(bd, c(asiste="ns01a_06")) %>%
rename(bd, c(trab_1hr="ns02a_01")) %>%
rename(bd, c(lug_trab="ns02b_15")) %>%
rename(bd, c(afecta="ns02b_19_2a")) %>%
rename(bd, c(deacuerdo="ns02b_20")) %>%
rename(bd, c(pago="ns02c_26")) %>%
rename(bd, c(lab_dom="ns03a_04")) %>%
rename(bd, c(lab_dom="ns03a_04")) %>%
```
rename(bd, c(lab_dom="ns03a_04")) %>% ## Minería de datos
bd <- rename(bd, c(sabeLeer="ns01a_01")) %>%
rename(bd, c(sexo="ns001a_02")) %>%
rename(bd, c(edad="ns001a_03")) %>%
rename(bd, c(nivel_ciclo="ns01a_02a")) %>%
rename(bd, c(curso_grado="ns01a_02b")) %>%
rename(bd, c(turno="ns01a_05c")) %>%
rename(bd, c(asiste="ns01a_06")) %>%
rename(bd, c(trab_1hr="ns02a_01")) %>%
rename(bd, c(lug_trab="ns02b_15")) %>%
rename(bd, c(afecta="ns02b_19_2a")) %>%
rename(bd, c(deacuerdo="ns02b_20")) %>%
rename(bd, c(pago="ns02c_26")) %>%
rename(bd, c(lab_dom="ns03a_04")) %>%
rename(bd, c(lab_dom="ns03a_04")) %>%
rename(bd, c(lab_dom="ns03a_04")) %>%
rename(bd, c(lab_dom="ns03a_04")) %>%
```
bd <- nna %>% select(condac,depto,area,ns001a_02,ns001a_03,ns01a_01,ns01a_02a,ns01a_02b,ns01a_05c,ns01a_06,ns02a_01,ns02b_15,ns02b_19_2a,ns02b_20,ns02c_26,ns03a_04,ns03b_06,ncob_op,ncaeb_op,catactlab,catactlab_pd2)
aux<-c("ns01a_01","ns01a_06","ns02a_01","ns02b_20","ns03a_04","ns03b_06")
for(i in aux){
bd[[i]]<-factor(bd[[i]],c("1.Si","2.No"),c("SI","NO"))
}
bd <- rename(bd, c(sabeLeer="ns01a_01")) %>%
rename(bd, c(sexo="ns001a_02")) %>%
rename(bd, c(edad="ns001a_03")) %>%
rename(bd, c(nivel_ciclo="ns01a_02a")) %>%
rename(bd, c(curso_grado="ns01a_02b")) %>%
rename(bd, c(turno="ns01a_05c")) %>%
rename(bd, c(asiste="ns01a_06")) %>%
rename(bd, c(trab_1hr="ns02a_01")) %>%
rename(bd, c(lug_trab="ns02b_15")) %>%
rename(bd, c(afecta="ns02b_19_2a")) %>%
rename(bd, c(deacuerdo="ns02b_20")) %>%
rename(bd, c(pago="ns02c_26")) %>%
rename(bd, c(lab_dom="ns03a_04")) %>%
rename(bd, c(car_pes="ns03b_06")) %>%
rename(bd, c(grupo="ncob_op")) %>%
rename(bd, c(clasi="ncaeb_op")) %>%
rename(bd, c(categ="catactlab")) %>%
rename(bd, c(clasi="ncaeb_op")) %>%
rename(bd, c(act_lab="catactlab_pd2")) %>%
```
bd <- rename(bd, c(sabeLeer="ns01a_01")) %>% rename(bd, c(sexo="ns001a_02")) %>% rename(bd, c(edad="ns001a_03")) %>% rename(bd, c(nivel_ciclo="ns01a_02a")) %>% rename(bd, c(curso_grado="ns01a_02b")) %>% rename(bd, c(turno="ns01a_05c")) %>% rename(bd, c(asiste="ns01a_06")) %>% rename(bd, c(trab_1hr="ns02a_01")) %>% rename(bd, c(lug_trab="ns02b_15")) %>% rename(bd, c(afecta="ns02b_19_2a")) %>% rename(bd, c(deacuerdo="ns02b_20")) %>% rename(bd, c(pago="ns02c_26")) %>% rename(bd, c(lab_dom="ns03a_04")) %>% rename(bd, c(car_pes="ns03b_06")) %>% rename(bd, c(grupo="ncob_op")) %>% rename(bd, c(clasi="ncaeb_op")) %>% rename(bd, c(categ="catactlab")) %>% rename(bd, c(clasi="ncaeb_op")) %>% rename(bd, c(act_lab="catactlab_pd2"))
library(tidyverse)
library(tidyverse)
bd <- rename(bd, c(sabeLeer="ns01a_01")) %>% rename(bd, c(sexo="ns001a_02")) %>% rename(bd, c(edad="ns001a_03")) %>% rename(bd, c(nivel_ciclo="ns01a_02a")) %>% rename(bd, c(curso_grado="ns01a_02b")) %>% rename(bd, c(turno="ns01a_05c")) %>% rename(bd, c(asiste="ns01a_06")) %>% rename(bd, c(trab_1hr="ns02a_01")) %>% rename(bd, c(lug_trab="ns02b_15")) %>% rename(bd, c(afecta="ns02b_19_2a")) %>% rename(bd, c(deacuerdo="ns02b_20")) %>% rename(bd, c(pago="ns02c_26")) %>% rename(bd, c(lab_dom="ns03a_04")) %>% rename(bd, c(car_pes="ns03b_06")) %>% rename(bd, c(grupo="ncob_op")) %>% rename(bd, c(clasi="ncaeb_op")) %>% rename(bd, c(categ="catactlab")) %>% rename(bd, c(clasi="ncaeb_op")) %>% rename(bd, c(act_lab="catactlab_pd2"))
View(bd)
bd <- nna %>% select(condac,depto,area,ns001a_02,ns001a_03,ns01a_01,ns01a_02a,ns01a_02b,ns01a_05c,ns01a_06,ns02a_01,ns02b_15,ns02b_19_2a,ns02b_20,ns02c_26,ns03a_04,ns03b_06,ncob_op,ncaeb_op,catactlab,catactlab_pd2)
aux<-c("ns01a_01","ns01a_06","ns02a_01","ns02b_20","ns03a_04","ns03b_06")
for(i in aux){
bd[[i]]<-factor(bd[[i]],c("1.Si","2.No"),c("SI","NO"))
}
library(tidyverse)
bd %>% rename(sabeLeer=ns01a_01,sexo=ns001a_02,edad=ns001a_03,nivel_ciclo=ns01a_02a,curso_grado=ns01a_02b,turno=ns01a_05c,asiste=ns01a_06,trab_1hr=ns02a_01,lug_trab=ns02b_15,afecta=ns02b_19_2a,deacuerdo=ns02b_20,pago=ns02c_26,lab_dom=ns03a_04,car_pes=ns03b_06,grupo=ncob_op,clasi=ncaeb_op,categ=catactlab,clasi=ncaeb_op,act_lab=catactlab_pd2)
bd <- bd %>% rename(sabeLeer=ns01a_01,sexo=ns001a_02,edad=ns001a_03,nivel_ciclo=ns01a_02a,curso_grado=ns01a_02b,turno=ns01a_05c,asiste=ns01a_06,trab_1hr=ns02a_01,lug_trab=ns02b_15,afecta=ns02b_19_2a,deacuerdo=ns02b_20,pago=ns02c_26,lab_dom=ns03a_04,car_pes=ns03b_06,grupo=ncob_op,clasi=ncaeb_op,categ=catactlab,clasi=ncaeb_op,act_lab=catactlab_pd2)
## Bases: trainbd, testbd
library(rpart)
set.seed(123)
index = sample(1:2, nrow(bd), replace = TRUE, prob=c(0.7, 0.3))
prop.table(table(index))
trainbd<-bd[index==1,]
testbd<-bd[index==2,]
mod1<-rpart(condac~.,data=trainbd)
#Explorar los nodos creados por rpart
mod1
#Examinar los parámetros del árbol con printcp
printcp(mod1)
#Usar el comando plotcp para explorar los parámetros de forma gráfica
plotcp(mod1)
#Usar la función summary para para examinar el modelo
summary(mod1)
#Visualizar el árbol
plot(mod1)
text(mod1,all=T,use.n=T)
#install.packages("rpart.plot")
library(rpart.plot)
rpart.plot(mod1)
clase<-predict(mod1,testbd,type = "class")
table(clase,testbd$condac)
install.packages("caret")
install.packages("caret")
#install.packages("caret")
library(caret)
confusionMatrix(table(clase,testbd$condac))
#install.packages("caret")
library(caret)
confusionMatrix(table(clase,testbd$condac))
install.packages('caret')
#install.packages('caret')
library(caret)
confusionMatrix(table(clase,testbd$condac))
bd2 <- nna %>% select(condac,depto,area,ns001a_02,ns001a_03,ns01a_01,ns01a_02a,ns01a_02b,ns01a_05c,ns01a_06,ns02b_15,ns02b_19_2a,ns02b_20,ns02c_26,ns03a_04,ns03b_06,ncob_op,ncaeb_op,catactlab,catactlab_pd2)
library(dplyr)
bd2 <- nna %>% select(condac,depto,area,ns001a_02,ns001a_03,ns01a_01,ns01a_02a,ns01a_02b,ns01a_05c,ns01a_06,ns02b_15,ns02b_19_2a,ns02b_20,ns02c_26,ns03a_04,ns03b_06,ncob_op,ncaeb_op,catactlab,catactlab_pd2)
aux2<-c("ns01a_01","ns01a_06","ns02b_20","ns03a_04","ns03b_06")
for(i in aux2){
bd2[[i]]<-factor(bd2[[i]],c("1.Si","2.No"),c("SI","NO"))
}
bd2 <- bd %>% rename(sabeLeer=ns01a_01,sexo=ns001a_02,edad=ns001a_03,nivel_ciclo=ns01a_02a,curso_grado=ns01a_02b,turno=ns01a_05c,asiste=ns01a_06,lug_trab=ns02b_15,afecta=ns02b_19_2a,deacuerdo=ns02b_20,pago=ns02c_26,lab_dom=ns03a_04,car_pes=ns03b_06,grupo=ncob_op,clasi=ncaeb_op,categ=catactlab,clasi=ncaeb_op,act_lab=catactlab_pd2)
bd2 <- nna %>% select(condac,depto,area,ns001a_02,ns001a_03,ns01a_01,ns01a_02a,ns01a_02b,ns01a_05c,ns01a_06,ns02b_15,ns02b_19_2a,ns02b_20,ns02c_26,ns03a_04,ns03b_06,ncob_op,ncaeb_op,catactlab,catactlab_pd2)
aux2<-c("ns01a_01","ns01a_06","ns02b_20","ns03a_04","ns03b_06")
for(i in aux2){
bd2[[i]]<-factor(bd2[[i]],c("1.Si","2.No"),c("SI","NO"))
}
bd2 <- bd %>% rename(sabeLeer=ns01a_01,sexo=ns001a_02,edad=ns001a_03,nivel_ciclo=ns01a_02a,curso_grado=ns01a_02b,turno=ns01a_05c,asiste=ns01a_06,lug_trab=ns02b_15,afecta=ns02b_19_2a,deacuerdo=ns02b_20,pago=ns02c_26,lab_dom=ns03a_04,car_pes=ns03b_06,grupo=ncob_op,clasi=ncaeb_op,categ=catactlab,clasi=ncaeb_op,act_lab=catactlab_pd2)
View(bd2)
bd2 <- bd2 %>% rename(sabeLeer=ns01a_01,sexo=ns001a_02,edad=ns001a_03,nivel_ciclo=ns01a_02a,curso_grado=ns01a_02b,turno=ns01a_05c,asiste=ns01a_06,lug_trab=ns02b_15,afecta=ns02b_19_2a,deacuerdo=ns02b_20,pago=ns02c_26,lab_dom=ns03a_04,car_pes=ns03b_06,grupo=ncob_op,clasi=ncaeb_op,categ=catactlab,clasi=ncaeb_op,act_lab=catactlab_pd2)
## Bases: trainbd, testbd
library(rpart)
index = sample(1:2, nrow(bd2), replace = TRUE, prob=c(0.7, 0.3))
prop.table(table(index))
trainbd<-bd2[index==1,]
testbd<-bd2[index==2,]
mod1<-rpart(condac~.,data=trainbd)
mod2<-rpart(condac~.,data=trainbd)
set.seed(123)
index = sample(1:2, nrow(bd), replace = TRUE, prob=c(0.7, 0.3))
prop.table(table(index))
trainbd<-bd[index==1,]
testbd<-bd[index==2,]
mod1<-rpart(condac~.,data=trainbd)
index2 = sample(1:2, nrow(bd2), replace = TRUE, prob=c(0.7, 0.3))
prop.table(table(index2))
trainbd2<-bd2[index==1,]
testbd2<-bd2[index==2,]
mod2<-rpart(condac~.,data=trainbd)
mod2
printcp(mod2)
plotcp(mod2)
rpart.plot(mod2)
#install.packages("rpart.plot")
library(rpart.plot)
rpart.plot(mod2)
#Visualizar el árbol
plot(mod2)
text(mod2,all=T,use.n=T)
#install.packages("rpart.plot")
library(rpart.plot)
#install.packages("rpart.plot")
library(rpart.plot)
rpart.plot(mod2)
bd2 <- nna %>% select(condac,depto,area,ns001a_02,ns001a_03,ns01a_01,ns01a_02a,ns01a_02b,ns01a_05c,ns01a_06,ns02b_15,ns02b_19_2a,ns02b_20,ns02c_26,ns03a_04,ns03b_06,ncob_op,ncaeb_op,catactlab,catactlab_pd2)
aux2<-c("ns01a_01","ns01a_06","ns02b_20","ns03a_04","ns03b_06")
bd2[[i]]<-factor(bd2[[i]],c("1.Si","2.No"),c("SI","NO"))
for(i in aux2){
bd2[[i]]<-factor(bd2[[i]],c("1.Si","2.No"),c("SI","NO"))
}
bd2 <- bd2 %>% rename(sabeLeer=ns01a_01,sexo=ns001a_02,edad=ns001a_03,nivel_ciclo=ns01a_02a,curso_grado=ns01a_02b,turno=ns01a_05c,asiste=ns01a_06,lug_trab=ns02b_15,afecta=ns02b_19_2a,deacuerdo=ns02b_20,pago=ns02c_26,lab_dom=ns03a_04,car_pes=ns03b_06,grupo=ncob_op,clasi=ncaeb_op,categ=catactlab,clasi=ncaeb_op,act_lab=catactlab_pd2)
set.seed(123)
index2 = sample(1:2, nrow(bd2), replace = TRUE, prob=c(0.7, 0.3))
prop.table(table(index2))
trainbd2<-bd2[index==1,]
testbd2<-bd2[index==2,]
index2 = sample(1:2, nrow(bd2), replace = TRUE, prob=c(0.7, 0.3))
prop.table(table(index2))
trainbd2<-bd2[index2==1,]
testbd2<-bd2[index2==2,]
mod2<-rpart(condac~.,data=trainbd)
mod2<-rpart(condac~.,data=trainbd2)
mod2
printcp(mod2)
plotcp(mod2)
#Visualizar el árbol
plot(mod2)
text(mod2,all=T,use.n=T)
#install.packages("rpart.plot")
library(rpart.plot)
rpart.plot(mod2)
confusionMatrix(table(clase,testbd2$condac))
confusionMatrix(table(clase2,testbd2$condac))
clase2<-predict(mod2,testbd2,type = "class")
confusionMatrix(table(clase2,testbd2$condac))
